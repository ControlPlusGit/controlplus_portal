/* 
 * File:   FSM_DataHora.h
 * Author: Vitor
 *
 * Created on 30 de Janeiro de 2020, 17:18
 */

#ifndef TESTEMAQUINAESTADO_H
#define	TESTEMAQUINAESTADO_H

#ifdef	__cplusplus
extern "C" {
#endif

#define NAO 0
#define SIM 1
    
#define TEMPO_ENTRE_ESTADOS_FSM_DATA_HORA 1
    
#define TEMPO_AGUARDANDO_ACK 2000
        
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// FUNÇÃO: inicializaMaquinaDeEstados_DataHora
// PARÂMETROS: nenhum
// UTILIZADA EM: logicaDeEmpilhadeiraV2
// FUNÇÃO: inicializa as variáveis necessárias para o funcionamento da máquina de estados
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    void inicializaMaquinaDeEstados_DataHora(void);

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// FUNÇÃO: habilitaMaquinaDeEstados_DataHora
// PARÂMETROS: nenhum
// UTILIZADA EM: logicaDeEmpilhadeiraV2
// FUNÇÃO: libera a máquina de estados para execução
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    void habilitaMaquinaDeEstados_DataHora(void);
    
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// FUNÇÃO: executaMaquinaDeEstados_DataHora
// PARÂMETROS: nenhum
// UTILIZADA EM: tick
// FUNÇÃO: executa a máquina de estados. Essa função é executada com interrupção de timer
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    void executaMaquinaDeEstados_DataHora(void);

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// FUNÇÃO: bloqueiaMaquinaDeEstados_DataHora
// PARÂMETROS: nenhum
// UTILIZADA EM: logicaDeEmpilhadeiraV2
// FUNÇÃO: bloqueia a execução da máquina de estados
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    void bloqueiaMaquinaDeEstados_DataHora(void);
    
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// FUNÇÃO: recebeDadoNaMaquinaDeEstados_DataHora
// PARÂMETROS: char dado
// UTILIZADA EM: _U2RXInterrupt
// FUNÇÃO: insere um valor char dentro de uma posição de mensagemSARS
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// 
    void recebeDadoNaMaquinaDeEstados_DataHora(char dado);
    
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// FUNÇÃO: zeraPonteiroDoBufferNaMaquinaDeEstados_DataHora
// PARÂMETROS: nenhum
// UTILIZADA EM: _U2RXInterrupt
// FUNÇÃO: atribui zero à variável contadorMensagemSARS
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////   
    void zeraPonteiroDoBufferNaMaquinaDeEstados_DataHora(void);
    
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// FUNÇÃO: limpaBufferNaMaquinaDeEstados_DataHora
// PARÂMETROS: nenhum
// UTILIZADA EM: executaMaquinaDeEstados_DataHoras
// FUNÇÃO: limpa o buffer de mensagens recebidas da UART2
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    void limpaBufferNaMaquinaDeEstados_DataHora(void);
    
    void incrementaContadorExecucao_FSM_DataHora(void);    
    
    void zeraContadorExecucao_FSM_DataHora(void);
      
    void atualizaDataHoraNoRTC_FSM_DataHora(void);
    
#ifdef	__cplusplus
}
#endif

#endif	/* TESTEMAQUINAESTADO_H */

