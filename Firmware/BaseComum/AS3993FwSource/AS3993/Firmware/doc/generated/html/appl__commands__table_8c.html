<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>as3993 Firmware: appl_commands_table.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">as3993 Firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3b1dcce1203a4246271d0209b54aa6ca.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">appl_commands_table.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="as3993__config_8h_source.html">as3993_config.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="as3993_8h_source.html">as3993.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="global_8h_source.html">global.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="appl__commands_8h_source.html">appl_commands.h</a>&quot;</code><br/>
</div>
<p><a href="appl__commands__table_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a84f0c66d6ac5157a6a525c989e5c513f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#a84f0c66d6ac5157a6a525c989e5c513f">callWrongCommand</a> (void)</td></tr>
<tr class="separator:a84f0c66d6ac5157a6a525c989e5c513f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c822618943e03b8d35636953ed48031"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#a1c822618943e03b8d35636953ed48031">callReaderConfig</a> (void)</td></tr>
<tr class="separator:a1c822618943e03b8d35636953ed48031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f0c721b0cbca9df52572cf6592bc9b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#a5f0c721b0cbca9df52572cf6592bc9b0">callTunerTable</a> (void)</td></tr>
<tr class="separator:a5f0c721b0cbca9df52572cf6592bc9b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b4e0cf1453d55bf883e903f325ca613"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#a4b4e0cf1453d55bf883e903f325ca613">callAutoTuner</a> (void)</td></tr>
<tr class="separator:a4b4e0cf1453d55bf883e903f325ca613"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35a9905055fe3ca4c2808d090f714bbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#a35a9905055fe3ca4c2808d090f714bbf">callAntennaTuner</a> (void)</td></tr>
<tr class="separator:a35a9905055fe3ca4c2808d090f714bbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0c3c7d6c275324c7abb8d2915ce1f1d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#aa0c3c7d6c275324c7abb8d2915ce1f1d">callAntennaPower</a> (void)</td></tr>
<tr class="separator:aa0c3c7d6c275324c7abb8d2915ce1f1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecdca38aa1df79e475162b4e96b0a747"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#aecdca38aa1df79e475162b4e96b0a747">callConfigGen2</a> (void)</td></tr>
<tr class="separator:aecdca38aa1df79e475162b4e96b0a747"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28676c97fde8b52b4191754db6a2d9cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#a28676c97fde8b52b4191754db6a2d9cc">callConfigTxRx</a> (void)</td></tr>
<tr class="separator:a28676c97fde8b52b4191754db6a2d9cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0084a821c065f158145ea30fbfb1c7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#aa0084a821c065f158145ea30fbfb1c7a">callInventory6B</a> (void)</td></tr>
<tr class="separator:aa0084a821c065f158145ea30fbfb1c7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4aa8d85b28f07d51b02630b43262a27"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#aa4aa8d85b28f07d51b02630b43262a27">callReadFromTag6B</a> (void)</td></tr>
<tr class="separator:aa4aa8d85b28f07d51b02630b43262a27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8c8c214b2260b9c5c2bce49e4d4ed50"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#ac8c8c214b2260b9c5c2bce49e4d4ed50">callWriteToTag6B</a> (void)</td></tr>
<tr class="separator:ac8c8c214b2260b9c5c2bce49e4d4ed50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7538f453a5d43b7ec063517853847ac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#af7538f453a5d43b7ec063517853847ac">callInventoryGen2</a> (void)</td></tr>
<tr class="separator:af7538f453a5d43b7ec063517853847ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34b95e06e77ecac99ce20894c4767f99"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#a34b95e06e77ecac99ce20894c4767f99">callSelectTag</a> (void)</td></tr>
<tr class="separator:a34b95e06e77ecac99ce20894c4767f99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b5124948787e4620bba229d08ea33ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#a6b5124948787e4620bba229d08ea33ff">callWriteToTag</a> (void)</td></tr>
<tr class="separator:a6b5124948787e4620bba229d08ea33ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedfb9442ef8ad6a06ce1113820bd41e6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#aedfb9442ef8ad6a06ce1113820bd41e6">callChangeFreq</a> (void)</td></tr>
<tr class="separator:aedfb9442ef8ad6a06ce1113820bd41e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e8235cc0b2cb1df5b04a0847f0a0765"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#a1e8235cc0b2cb1df5b04a0847f0a0765">callReadFromTag</a> (void)</td></tr>
<tr class="separator:a1e8235cc0b2cb1df5b04a0847f0a0765"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3390fb37b1bd80a84304a5deb852af7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#a3390fb37b1bd80a84304a5deb852af7a">callLockUnlockTag</a> (void)</td></tr>
<tr class="separator:a3390fb37b1bd80a84304a5deb852af7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d55f0bf20c6e53f25602cf3f15ee3a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#a6d55f0bf20c6e53f25602cf3f15ee3a8">callKillTag</a> (void)</td></tr>
<tr class="separator:a6d55f0bf20c6e53f25602cf3f15ee3a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6958165c8330ea8d526edf669d0cb5e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#a6958165c8330ea8d526edf669d0cb5e3">callStartStop</a> (void)</td></tr>
<tr class="separator:a6958165c8330ea8d526edf669d0cb5e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4b7b90160112ff5364abdef36111f4dd"><td class="memItemLeft" align="right" valign="top">struct callFunction&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="appl__commands__table_8c.html#a4b7b90160112ff5364abdef36111f4dd">call_fkt_</a> [CALL_FKT_SIZE]</td></tr>
<tr class="separator:a4b7b90160112ff5364abdef36111f4dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Table to branch into the functions associated with a specific command. </p>
<p>This file provides a table (<a class="el" href="appl__commands__table_8c.html#a4b7b90160112ff5364abdef36111f4dd">call_fkt_()</a>) which allows to branch into functions depending on which command has been received. Each command has an 8bit identifier. This identifier is also used as offset in the table, to branch into the corresponding function. The 8bit identifier is rx-ed from the host (command ID) as described in <a class="el" href="appl__commands_8h.html#streamprotocol">Protocol description</a>.</p>
<dl class="section author"><dt>Author</dt><dd>Ulrich Herrmann </dd>
<dd>
Bernhard Breinbauer </dd></dl>

<p>Definition in file <a class="el" href="appl__commands__table_8c_source.html">appl_commands_table.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aa0c3c7d6c275324c7abb8d2915ce1f1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callAntennaPower </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function enables/disables the RF field and is executed when a stream packet with protocol = <a class="el" href="appl__commands_8h.html#aabd4ed851071e30df6e08ddcab06ea8c">CMD_ANTENNA_POWER</a> is received.<br/>
 The payload of the stream packet looks like this: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0 </th><th>1  </th></tr>
<tr>
<th>Content</th><td>0x00 for off<br/>
0xFF for on</td><td>eval_mode </td></tr>
</table>
<p>eval_mode: reserved, should be zero <br/>
 The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0  </th></tr>
<tr>
<th>Content</th><td>0  </td></tr>
</table>
<p>Status of the reply packet indicates success or error. </p>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l00372">372</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a35a9905055fe3ca4c2808d090f714bbf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callAntennaTuner </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function sets and reads antenna tuner network related values and is executed when a stream packet with protocol = <a class="el" href="appl__commands_8h.html#a5453168be64b395e7046d2e69ccee5b1">CMD_ANTENNA_TUNER</a> is received. There are different kind of tuning networks available. The full network which is currently supported by the Firmware looks like this: </p>
<div class="fragment"><div class="line">                       .--- L ---.</div>
<div class="line">                       |        |</div>
<div class="line">in ----.----.----- L --.--C_len--.--.-----.-----.----- out</div>
<div class="line">       |    |                      |     |     |</div>
<div class="line">      C_in  L                     C_out   L     R</div>
<div class="line">       |    |                      |     |     |</div>
<div class="line">      ___  ___                    ___   ___   ___</div>
<div class="line">       -    -                      -     -     -</div>
<div class="line">       <span class="stringliteral">&#39;    &#39;</span>                      <span class="stringliteral">&#39;     &#39;</span>     <span class="stringliteral">&#39;</span></div>
</div><!-- fragment --><p> On the Femto Reader there is a reduced tuning network: Clen is missing.<br/>
 The DTCs capacity values range from: </p>
<ul>
<li>
C_* = 32 steps from 1.3pF to 5.5pF, step size 0.131pF, +-10%  </li>
</ul>
<p>The format of the payload from the host is: Get/Set current tuner parameters: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5  </th></tr>
<tr>
<th>Content </th><td>set_cin </td><td>cin </td><td>set_clen </td><td>clen </td><td>set_cout </td><td>cout  </td></tr>
</table>
<p>The values are only being set if the proper set_X value is set to 1.<br/>
 The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5  </th></tr>
<tr>
<th>Content </th><td>reserved (0) </td><td>cin </td><td>reserved(0) </td><td>clen </td><td>reserved(0) </td><td>cout  </td></tr>
</table>
<p>Reply status will be set to ERR_NONE if operation was successful. If reader does not support tuning status will be set to ERR_REQUEST. </p>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l00471">471</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4b4e0cf1453d55bf883e903f325ca613"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callAutoTuner </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function allows to trigger a auto tuning cycle. For in detail information to antenna tuning see <a class="el" href="appl__commands_8c.html#a35a9905055fe3ca4c2808d090f714bbf">callAntennaTuner()</a> and <a class="el" href="tuner_8h.html" title="This file provides declarations for tuner related functions.">tuner.h</a>.<br/>
 The function is executed when a stream packet with protocol = <a class="el" href="appl__commands_8h.html#ae9746ef6eb31517741ee6de67be73a1f">CMD_AUTO_TUNER</a> is received. The format of the payload from the host is: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0  </th></tr>
<tr>
<th>Content </th><td>auto_tune  </td></tr>
</table>
<p>If the auto_tune value is not equal zero a auto tuner cycle will be started: </p>
<ul>
<li>
0: no autotuning will be done. </li>
<li>
1: autotune procedure <a class="el" href="tuner_8h.html#aafd8b97bdd1043b5beebb3876656ab0d">tunerOneHillClimb()</a> will be performed. </li>
<li>
2: autotune procedure <a class="el" href="tuner_8h.html#a06dcb31f7e9de80ce5cb21fe9536f415">tunerMultiHillClimb()</a> will be performed. </li>
</ul>
<p><br/>
 The device does not send a reply back, but the result of the auto tuning procedure can be read by <a class="el" href="appl__commands_8c.html#a35a9905055fe3ca4c2808d090f714bbf">callAntennaTuner()</a>. <br/>
 </p>
<dl class="section note"><dt>Note</dt><dd>Depending on the used auto tune algorithm there will be some delay until the tune algorithm finshed and the new tuned DTC values are avaiable. The tuner algorithm 2 takes roughly 3 seconds, algorithm 1 is faster. </dd></dl>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l00582">582</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="aedfb9442ef8ad6a06ce1113820bd41e6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callChangeFreq </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function sets/adds/measures frequency related stuff and is executed when a stream packet with protocol = <a class="el" href="appl__commands_8h.html#a7898caa558c2b7ed52cc2bb0d45f008a">CMD_CHANGE_FREQ</a> is received. </p>
<dl class="section note"><dt>Note</dt><dd>The freq parameter contains the frequency in kHz and is always 3 bytes long. The first byte in the payload is the LSB. The frequency is extracted from the payload like this: <div class="fragment"><div class="line">u32 freq;</div>
<div class="line">freq = 0;</div>
<div class="line">freq += (u32)<a class="code" href="appl__commands_8c.html#a2d08ebb9a9682b8fb311de926df1cbb2">cmdBuffer</a>.rxData[2];</div>
<div class="line">freq += ((u32)<a class="code" href="appl__commands_8c.html#a2d08ebb9a9682b8fb311de926df1cbb2">cmdBuffer</a>.rxData[3]) &lt;&lt; 8;</div>
<div class="line">freq += ((u32)<a class="code" href="appl__commands_8c.html#a2d08ebb9a9682b8fb311de926df1cbb2">cmdBuffer</a>.rxData[4]) &lt;&lt; 16;</div>
</div><!-- fragment --></dd></dl>
<p>The format of the payload received from the host is one of the following: </p>
<ul>
<li>
<p class="startli">Get RSSI level </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1 .. 3 </th></tr>
<tr>
<th>Content</th><td>1 (SubCmd)</td><td>freq  </td></tr>
</table>
<p>to which the reader replies with: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 </th></tr>
<tr>
<th>Content</th><td>I-channel</td><td>Q-channel</td><td>dBm </td></tr>
</table>
<p>Where I and Q channel contain the raw value from register 0x2B and dBm is the approximate dBm value calculated by taking gain settings and single/balanced input into account.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Get Reflected Power level </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1 .. 3 </th></tr>
<tr>
<th>Content</th><td>2 (SubCmd)</td><td>freq  </td></tr>
</table>
<p>to which the reader replies with: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1 </th></tr>
<tr>
<th>Content</th><td>I-channel</td><td>Q-channel </td></tr>
</table>
<p class="endli"></p>
</li>
<li>
<p class="startli">Add frequency to frequency list used for hopping. If clear_list is set the list will be deleted before adding the new frequency. rssi_threshhold and profile_id are global values and not set for every frequency. Therefore the last value which they have been set to is valid. </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1 .. 3</th><th>4 </th><th>5 </th><th>6  </th></tr>
<tr>
<th>Content</th><td>4 (SubCmd)</td><td>freq </td><td>clear_list</td><td>rssi_threshhold(dBm)</td><td>profile_id </td></tr>
</table>
<p>Where rssi_threshold is used by the "listen before talk" feature: Before hopping to a new channel the reader listens on the frequency if the rssi value is smaller than this threshold.<br/>
 profile_id is used by the Reader Suite to enumerate the various frequency profiles. <br/>
 The reader replies with this: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0 </th></tr>
<tr>
<th>Content</th><td>0x00 </td></tr>
</table>
<p>Status will be set to ERR_MEM if no more frequency can be added (see <a class="el" href="global_8h.html#af8269d8159f700256b8bd0fb67b5a882">MAXFREQ</a>). If command was successful status will be ERR_NONE.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Get frequency list related parameters </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0 </th></tr>
<tr>
<th>Content</th><td>5 (SubCmd) </td></tr>
</table>
<p>The reader replies with: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0 </th><th>1 .. 3 </th><th>4 .. 6 </th><th>7 </th><th>8  </th></tr>
<tr>
<th>Content</th><td>profile_id</td><td>min_freq</td><td>max_freq</td><td>curr_num_freqs</td><td>host_num_freqs </td></tr>
</table>
<p>Where profile_id and rssi_threshold refer to the values used in SubCmd 4. Values for the other parameters are: </p>
<table class="doxtable">
<tr>
<th>Name</th><th>values </th></tr>
<tr>
<td>min_freq</td><td>Minimum frequency of current frequency list.  </td></tr>
<tr>
<td>max_freq</td><td>Maximum frequency of current frequency list.  </td></tr>
<tr>
<td>curr_num_freq</td><td>Number of frequencies in current frequency list.  </td></tr>
<tr>
<td>host_num_freq</td><td>Number of frequencies the host sent to add with SubCmd 4. Might be bigger than curr_num_freq.  </td></tr>
</table>
<p class="endli"></p>
</li>
<li>
<p class="startli">Set frequency hopping related parameters </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1 .. 2 </th><th>3 .. 4 </th><th>5 .. 6  </th></tr>
<tr>
<th>Content</th><td>8 (SubCmd)</td><td>listeningTime</td><td>maxSendingTime</td><td>idleTime </td></tr>
</table>
<p>The reader replies with: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0 </th></tr>
<tr>
<th>Content</th><td>0x00 </td></tr>
</table>
<p>Status of reply will be ERR_NONE.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Get frequency hopping related parameters </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0 </th></tr>
<tr>
<th>Content</th><td>9 (SubCmd) </td></tr>
</table>
<p>The reader replies with: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0 .. 1 </th><th>2.. 3 </th><th>4 .. 5  </th></tr>
<tr>
<th>Content</th><td>listening_time</td><td>max_sending_time</td><td>idle_time </td></tr>
</table>
<p>Status of reply will be ERR_NONE.</p>
<p class="endli"></p>
</li>
<li>
Continuous modulation test <table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1 .. 3</th><th>4 .. 5 </th><th>6 </th><th>7 .. 16  </th></tr>
<tr>
<th>Content</th><td>16 (SubCmd)</td><td>freq </td><td>duration in ms</td><td>random</td><td>random_data </td></tr>
</table>
causes continuous modulation of the RF field for given duration. If random is set to 0 Gen2 NAK commands are sent (On AS3980 NAK direct command is not available therefore Transmit with CRC with dummy payload is used). If random is set to 1 pseudo random data is sent. For this the random_data and timer values are used as random data to send. <br/>
 <dl class="section note"><dt>Note</dt><dd>The reader does not reply any data to this command as it enters continuous modulation mode directly.</dd></dl>
<br/>
 <dl class="section note"><dt>Note</dt><dd>Communication with host is not possible while continous modulation is performed. Wait at least for duration time before starting communication attempt with reader.  </dd></dl>
</li>
</ul>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l02197">2197</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="aecdca38aa1df79e475162b4e96b0a747"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callConfigGen2 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function sets and reads various gen2 related settings and is executed when a stream packet with protocol = <a class="el" href="appl__commands_8h.html#a24a5f4690c03498db6b57957b979e934">CMD_CONFIG_TX_RX</a> is received. Most of the parameters are related to the QUERY commmand of the Gen2 protocol specification.<br/>
 The format of the payload from the host is: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th><th>6 </th><th>7 </th><th>8 </th><th>9 </th><th>10 </th><th>11 </th><th>12 </th><th>13 </th><th>14 </th><th>15  </th></tr>
<tr>
<th>Content </th><td>set_lf </td><td>lf </td><td>set_coding </td><td>coding </td><td>set_session </td><td>session </td><td>set_trext </td><td>trext </td><td>set_tari </td><td>tari </td><td>set_qbegin </td><td>qbegin </td><td>set_sel </td><td>sel </td><td>set_target </td><td>target  </td></tr>
</table>
<p>The values are only being set if the proper set_X value is set to 1.<br/>
 The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th><th>6 </th><th>7 </th><th>8 </th><th>9 </th><th>10 </th><th>11 </th><th>12 </th><th>13 </th><th>14 </th><th>15  </th></tr>
<tr>
<th>Content </th><td>reserved(0) </td><td>lf </td><td>reserved(0) </td><td>coding </td><td>reserved(0) </td><td>session </td><td>reserved(0) </td><td>trext </td><td>reserved(0) </td><td>tari </td><td>reserved(0) </td><td>qbegin </td><td>reserved(0) </td><td>sel </td><td>reserved(0) </td><td>target  </td></tr>
</table>
<p>Values for the different parameters are: </p>
<table class="doxtable">
<tr>
<th>Name</th><th>values </th></tr>
<tr>
<td>lf</td><td>0 = 40 kHz,<br/>
 3 = 80 kHz not AS3993,<br/>
 6 = 160 kHz,<br/>
 8 = 213 kHz,<br/>
 9 = 256 kHz,<br/>
 12 = 320 kHz,<br/>
 15 = 640 kHz  </td></tr>
<tr>
<td>coding</td><td>0 = FM0,<br/>
 1 = Miller2,<br/>
 2 = Miller4,<br/>
 3 = Miller8  </td></tr>
<tr>
<td>session</td><td>0 = S0,<br/>
 1 = S1,<br/>
 2 = S2,<br/>
 3 = S3  </td></tr>
<tr>
<td>trext</td><td>0 = short preamble, no pilot tone,<br/>
 1 = long preamble, pilot tone  </td></tr>
<tr>
<td>tari</td><td>0 = 6.25 us,<br/>
 1 = 12.5 us,<br/>
 2 = 25 us  </td></tr>
<tr>
<td>qbegin</td><td>0 .. 15. Initial gen2 round is 2^qbegin long. Please be careful with higher values.  </td></tr>
<tr>
<td>sel</td><td>0 .. 1 = All,<br/>
 2 = ~SL,<br/>
 3 = SL  </td></tr>
<tr>
<td>target</td><td>0 = A,<br/>
 1 = B  </td></tr>
</table>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l01391">1391</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a28676c97fde8b52b4191754db6a2d9cc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callConfigTxRx </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function sets and reads various RF Tx/Rx related settings and is executed when a stream packet with protocol = <a class="el" href="appl__commands_8h.html#a24a5f4690c03498db6b57957b979e934">CMD_CONFIG_TX_RX</a> is received. </p>
<dl class="section note"><dt>Note</dt><dd>Not every parameters is available on every board, eg: switching antenna boards is only available on boards with 2 antenna ports. The FW will silently ignore not applicable parameters.</dd></dl>
<p>The format of the payload from the host is: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th><th>6  </th></tr>
<tr>
<th>Content </th><td>set_sensitivity </td><td>sensitivity </td><td>set_antenna </td><td>antenna id </td><td>set_power </td><td>Transmit Power LSB </td><td>Transmit Power MSB  </td></tr>
</table>
<p>The values are only being set if the proper set_X value is set to 1.<br/>
 The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th><th>6 </th><th>7 </th><th>8  </th></tr>
<tr>
<th>Content </th><td>reserved(0) </td><td>sensitivity </td><td>reserved (0) </td><td>antenna id </td><td>reserved (0) </td><td>desired Transmit Power LSB </td><td>desired Transmit Power MSB </td><td>current Transmit Power LSB </td><td>current Transmit Power MSB  </td></tr>
</table>
<p>Values for the different parameters are: </p>
<table class="doxtable">
<tr>
<th>Name</th><th>values </th></tr>
<tr>
<td>sensitivity</td><td>-128 .. 127 (dBm)  </td></tr>
<tr>
<td>antenna id</td><td>1: antenna port 1<br/>
 2: antenna port 2  </td></tr>
<tr>
<td>Transmit Power</td><td>The desired transmit power which should be set.  </td></tr>
</table>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l01182">1182</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa0084a821c065f158145ea30fbfb1c7a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callInventory6B </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section attention"><dt>Attention</dt><dd>Do not use, ISO 6B not supported.</dd></dl>
<p>This function performs one inventory round using ISO18000-6b protocol. The format of the payload from the host is: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3 .. 10 </th><th>11 </th></tr>
<tr>
<th>Content</th><td><a class="el" href="appl__commands_8h.html#a7e3dc0b36e2bc6cece104b01a1849969">CMD_INVENTORY_6B</a></td><td>start</td><td>mask</td><td>word_data </td><td>start_address </td></tr>
</table>
<p>where </p>
<ul>
<li>
start: 1 -&gt; start a new round, 2 -&gt; deliver next tag  </li>
<li>
mask: the mask value for GROUP_SELECT_EQ command, 0 will select all tags </li>
<li>
start_address: address where data will be compared </li>
<li>
word_data: data which will be compared </li>
</ul>
<p>The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4 .. 11</th><th>12 .. 14  </th></tr>
<tr>
<th>Content</th><td>0x40(ID)</td><td>tags_left</td><td>rssi(planned)</td><td>8(epclen)</td><td>uid</td><td>used freq </td></tr>
</table>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l01465">1465</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="af7538f453a5d43b7ec063517853847ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callInventoryGen2 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This function performs a single gen2 protocol inventory round according to
</pre><p> parameters configured by <a class="el" href="appl__commands_8c.html#aecdca38aa1df79e475162b4e96b0a747">callConfigGen2()</a> and <a class="el" href="appl__commands_8c.html#a34b95e06e77ecac99ce20894c4767f99">callSelectTag()</a>.<br/>
 The function is executed when a stream packet with protocol = <a class="el" href="appl__commands_8h.html#aadf03fee9f8a67c1dfa31f7df6f3a42a">CMD_INVENTORY_GEN2</a> is received.<br/>
 The format of the payload from the host is: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0 </th><th>1 </th><th>2  </th></tr>
<tr>
<th>Content</th><td>autoAck </td><td>fast </td><td>rssi  </td></tr>
</table>
<p>Where autoAck defines if the autoACK mode of the reader is used. If autoAck = 0 autoACK will not be used, otherwise autoACK will be used. Parameter fast defines how the inventory rounds are performed. If fast = 0 the inventory round is executed until the tag is in the Open state. If fast = 1 the inventory round is stopped when the tag reaches Acknowledged state (no Req_RN command is sent). See Gen2 protocol specification page 47: Tag state diagram for details.<br/>
 The rssi parameter defines which rssi value should be measured when getting a tag. The value of rssi parameter will be written to register 0x29. <br/>
 The device sends back all the tags using the following report: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 .. 7 </th><th>8 </th><th>9 </th><th>10 </th><th>11 .. 11+epclen </th><th>12+epclen </th><th>13+epclen .. 15+epclen </th><th>...  </th></tr>
<tr>
<th>Content </th><td>cyclic </td><td>tags_left </td><td>tags_in_reply </td><td>AGC and status (reg 0x2A) </td><td>RSSI_value (reg 0x2B) </td><td>base_freq </td><td>epclen+pclen </td><td>pc[0] </td><td>pc[1] </td><td>epc  </td><td>next tag: RSSI </td><td>next tag: base_freq </td><td>...  </td></tr>
</table>
<ul>
<li>
cyclic: is set to 1 if cyclic(continuous) inventory rounds are performed, otherwise 0. </li>
<li>
tags_left: number of tags still to be sent after this reply. The next tag data will be sent in next iteration of <a class="el" href="appl__commands_8c.html#a4733229fa43daf734d41b9e53124bf74">sendTagData()</a>.  </li>
<li>
tags_in_reply: number of tags in reply.  </li>
<li>
agc and status: subc_phase, agc status, i/q channel (content of register 0x2A)  </li>
<li>
RSSI_value: upper 4 bits I channel, lower 4 bits Q channel (content of register 0x2B)  </li>
<li>
base_freq: base frequency at which the tag was found.  </li>
<li>
epclen+pclen: added length of pc and epc. </li>
</ul>
<p>Sending the reply is implemented in function <a class="el" href="appl__commands_8c.html#a4733229fa43daf734d41b9e53124bf74">sendTagData()</a>, which has to be called repeatedly until all tag data has been sent. </p>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l01696">1696</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6d55f0bf20c6e53f25602cf3f15ee3a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callKillTag </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function kills a gen2 tag and is executed when a stream packet with protocol = <a class="el" href="appl__commands_8h.html#a40d1668859176b751514277a1f8e0b41">CMD_KILL_TAG</a> is received. <br/>
 The format of the payload from the host is: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0 .. 3 </th><th>4  </th></tr>
<tr>
<th>Content</th><td>kill password</td><td>recom </td></tr>
</table>
<p>where: </p>
<ul>
<li>
recom: see GEN2 standard: table on "XPC_W1 LSBs and a Tag's recomissioned status"  </li>
</ul>
<p>The device sends back the following report: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0 </th></tr>
<tr>
<th>Content</th><td>status </td></tr>
</table>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l02602">2602</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3390fb37b1bd80a84304a5deb852af7a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callLockUnlockTag </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function locks\unlocks a gen2 tag and is executed when a stream packet with protocol = <a class="el" href="appl__commands_8h.html#a5fc9f71bb6af339af44ed0b0385ce47a">CMD_LOCK_UNLOCK_TAG</a> is received. <br/>
 The format of the payload from the host is: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0..2 </th><th>3 .. 5 </th></tr>
<tr>
<th>Content</th><td>mask_and_action</td><td>access password </td></tr>
</table>
<p>The device sends back the following report: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0 </th></tr>
<tr>
<th>Content</th><td>tag_code </td></tr>
</table>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l02542">2542</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1c822618943e03b8d35636953ed48031"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callReaderConfig </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function gets/sets the current reader config and is executed when a stream packet with protocol = <a class="el" href="appl__commands_8h.html#a6d602a64473f4e5821778f8455b6bddb">CMD_READER_CONFIG</a> is received. The reader config contains the power down mode which can be changed and various non-changeable parameters like: error codes, FW compile time switches, ...<br/>
 The format of the payload from the host is: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1  </th></tr>
<tr>
<th>Content </th><td>set_powermode </td><td>powermode  </td></tr>
</table>
<p>The values are only being set if the proper set_X value is set to 1.<br/>
 The powermode value will be applied to <a class="el" href="appl__commands_8c.html#a60f3be8f68d9c5368b6abb0b8d8e08bf">readerPowerDownMode</a> variable and used in <a class="el" href="appl__commands_8c.html#a342e25707653049940dd270528300681">powerDownReader()</a> and <a class="el" href="appl__commands_8c.html#a3f293d77dd654d2b73039d6e703173fd">powerUpReader()</a>.<br/>
 The device reply payload is: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0 </th><th>1 </th><th>2 </th><th>3 </th><th>4 </th><th>5 </th><th>6 </th><th>7 </th><th>8  </th></tr>
<tr>
<th>Content</th><td>WrongChipId</td><td>InitErrCode</td><td>VCO</td><td>PA</td><td>INPUT</td><td>AntSwitch</td><td>Tuner</td><td>powerDownMode</td><td>Hardware ID </td></tr>
</table>
<p>The values for the parameters are: </p>
<table class="doxtable">
<tr>
<th>Parameter</th><th>Values </th></tr>
<tr>
<td>WrongChipId</td><td>0-99: No Error. FW and reader chip match. The value is the last to digits of the reader chip eg: for AS3993 the value is 93.<br/>
 0xFF: FW is not compatible with the reader chip on this board. </td></tr>
<tr>
<td>Init Error</td><td>0: No Error. Init of reader chip was successful.<br/>
 1: Writing and reading SPI failed.<br/>
 2: Reset via EN low + high failed.<br/>
 3: IRQ line failed.<br/>
 4: Crystal not stable (Bit0 in AGC and Internal Status register 0x2A).<br/>
 5: PLL not locked (Bit1 in AGC and Internal Status register 0x2A) </td></tr>
<tr>
<td>VCO</td><td>0: FW was compiled for internal VCO (INTVCO).<br/>
 1: FW was compiled for external VCO (EXTVCO).<br/>
 </td></tr>
<tr>
<td>PA</td><td>0: FW was compiled for internal PA (INTPA).<br/>
 1: FW was compiled for external PA (EXTPA).<br/>
 </td></tr>
<tr>
<td>Input</td><td>0: FW was compiled for balanced input (BALANCEDINP).<br/>
 1: FW was compiled for single input (SINGLEINP).<br/>
 </td></tr>
<tr>
<td>AntSwitch</td><td>0: FW was not compiled for 2 antenna ports.<br/>
 1: FW was compiled to use 2 antenna ports (ANTENNA_SWITCH).<br/>
 </td></tr>
<tr>
<td>Tuner</td><td>Or'ed tuner configuration, every bit repesents a tunable cap (DTC).<br/>
 0: FW does not support tuning.<br/>
 0x01: Cin tuner is used (TUNER_CIN).<br/>
 0x02: Clen tuner is used (TUNER_CLEN).<br/>
 0x04: Cout tuner is used (TUNER_COUT).<br/>
 other bits: not yet supported. </td></tr>
<tr>
<td>powerDownMode</td><td>Currently configured power down mode of reader.<br/>
 Available modes are: <a class="el" href="appl__commands_8c.html#aad04e0c9afdeec307d5b9cb2062d784d">POWER_DOWN</a>, <a class="el" href="appl__commands_8c.html#a8f38f6931ed86223ee7c0c2abe6f6be0">POWER_NORMAL</a>, <a class="el" href="appl__commands_8c.html#a1935770366461815b288bcc3b8b37ea6">POWER_NORMAL_RF</a> and <a class="el" href="appl__commands_8c.html#afd79ef79e5360a5156b7da09736d8aa7">POWER_STANDBY</a>. </td></tr>
<tr>
<td>Hardware ID</td><td>Identification number for the board (#HARDWARE_ID_NUM)<br/>
 Available IDs are defined in <a class="el" href="as3993__config_8h.html" title="Configuration file for all AS99x firmware.">as3993_config.h</a> </td></tr>
</table>
<p>If any of the parameters is set to 0xFF an unidentified error/configuration occured. </p>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l00968">968</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1e8235cc0b2cb1df5b04a0847f0a0765"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callReadFromTag </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function reads from a previously selected gen2 tag and is executed when a stream packet with protocol = <a class="el" href="appl__commands_8h.html#afc529a7b5aa5cb56275ad689b7c5e6f5">CMD_READ_FROM_TAG</a> is received. <br/>
 The format of the payload from the host is: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2..5 </th></tr>
<tr>
<th>Content</th><td>mem_bank</td><td>address</td><td>password </td></tr>
</table>
<p>rxSize divided by two defines the number of words to be read. If rxSize is odd then word by word reading is used. If even the desired memory is read as one bulk. Parameters are: </p>
<ul>
<li>
mem_bank:<ul>
<li>
0:reserved membank</li>
<li>
1:EPC membank</li>
<li>
2:TID membank</li>
<li>
3:USER membank</li>
</ul>
</li>
<li>
address: the wordPtr where to read from </li>
</ul>
<p>The device sends back the following report: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0..txSize(max) </th></tr>
<tr>
<th>Content</th><td>data  </td></tr>
</table>
<p>If the returned error is ERR_HEADER, the txSize will be odd and the last byte will be the error code returned by the tag. </p>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l02442">2442</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa4aa8d85b28f07d51b02630b43262a27"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callReadFromTag6B </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section attention"><dt>Attention</dt><dd>Do not use, ISO 6B not supported.</dd></dl>
<p>This function reads from a tag using ISO18000-6b protocol command READ_VARIABLE. The format of the payload from the host is: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1 .. 8</th><th>9</th><th>10 </th></tr>
<tr>
<th>Content</th><td><a class="el" href="appl__commands_8h.html#a43eb37733e6f31469a6a0c175760f367">CMD_READ_FROM_TAG_6B</a></td><td>uid</td><td>addr</td><td>length_to_read </td></tr>
</table>
<p>where The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3 .. 3+length_to_read </th></tr>
<tr>
<th>Content</th><td>0x50(ID)</td><td>0 for success</td><td>length of data</td><td>data </td></tr>
</table>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l01563">1563</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a34b95e06e77ecac99ce20894c4767f99"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callSelectTag </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function singulates a Gen2 tag using the given mask for subsequent operations like inventory/read/write. Several (<a class="el" href="appl__commands_8c.html#ac5b08211d6fbf6b0d653ceb9caaad92b">MAX_SELECTS</a>) Select commands can be configured, which are executed sequentially, allowing union and intersection based tag partitioning. See Gen2 protocol specification for further details. <br/>
 This function is executed when a stream packet with protocol = <a class="el" href="appl__commands_8h.html#a3a49a6e4a35baaefa298625a9ca795f7">CMD_SELECT_TAG</a> is received. <br/>
 </p>
<dl class="section note"><dt>Note</dt><dd>This command will reply with ERR_REQUEST on AS3980 as Select command is not supported by AS3980.</dd></dl>
<p>The format of the payload received from the host is one of the following: </p>
<ul>
<li>
<p class="startli">Clear list of Select commands (no Select commands is executed): </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>...  </th></tr>
<tr>
<th>Content </th><td>0x00 (SubCmd ID) </td><td>ignored  </td></tr>
</table>
<p>The device sends back status ERR_NONE and no payload. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Add to list of Select commands, execute the Select commands and try to singulate a tag: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3 </th><th>4 .. 5 </th><th>6 </th><th>7 </th><th>8 .. 8 + mask_len  </th></tr>
<tr>
<th>Content </th><td>0x01 (SubCmd ID) </td><td>target </td><td>action </td><td>mem_bank </td><td>address </td><td>mask_len </td><td>truncate </td><td>mask  </td></tr>
</table>
<p>The device sends back a status (no payload). ERR_MEM if no more select command can be selected or a specific Gen2 error if singulating tag failed. </p>
<p class="endli"></p>
</li>
<li>
Clear list of Select commands, add to list of Select commands, execute the Select commands and try to singulate a tag: <table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2 </th><th>3 </th><th>4 .. 5 </th><th>6 </th><th>7 </th><th>8 .. 8 + mask_len  </th></tr>
<tr>
<th>Content </th><td>0x02 (SubCmd ID) </td><td>target </td><td>action </td><td>mem_bank </td><td>address </td><td>mask_len </td><td>truncate </td><td>mask  </td></tr>
</table>
The device sends back a status (no payload). ERR_MEM if no more select command can be selected or a specific Gen2 error if singulating tag failed.  </li>
</ul>
<p>Values for the different parameters are: </p>
<table class="doxtable">
<tr>
<th>Name</th><th>values </th></tr>
<tr>
<td>target</td><td>0 = Inventoried (S0),<br/>
 1 = Inventoried (S1),<br/>
 2 = Inventoried (S2),<br/>
 3 = Inventoried (S3),<br/>
 4 = SL,<br/>
 &gt;4 = RFU  </td></tr>
<tr>
<td>action</td><td>Action tag should perform is Select matches. See Table 6.20 in Gen2 protocol specification.  </td></tr>
<tr>
<td>mem_bank</td><td>0 = RFU,<br/>
 1 = EPC,<br/>
 2 = TID,<br/>
 3 = User  </td></tr>
<tr>
<td>address</td><td>16bit pointer in memory bank, where mask should be applied. Will be converted into EBV format before Select command is sent.  </td></tr>
<tr>
<td>mask_len</td><td>Length of mask in bits.  </td></tr>
<tr>
<td>truncate</td><td>0 = Disable truncation.<br/>
 1 = Enable truncation.  </td></tr>
<tr>
<td>mask</td><td>Actual mask data.  </td></tr>
</table>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l01853">1853</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6958165c8330ea8d526edf669d0cb5e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callStartStop </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function starts/stops cyclic inventory rounds and is executed when a stream packet with protocol = <a class="el" href="appl__commands_8h.html#a3b2ddd0f88475714d740caa5c9bfbc1c">CMD_START_STOP</a> is received.<br/>
 The cyclic inventory rounds are performed by calling <a class="el" href="appl__commands_8c.html#af7538f453a5d43b7ec063517853847ac">callInventoryGen2()</a> from the main loop. Therefore after starting a cyclic inventory, the host has to expect data just like after issueing the <a class="el" href="appl__commands_8c.html#af7538f453a5d43b7ec063517853847ac">callInventoryGen2()</a> because <a class="el" href="appl__commands_8c.html#a4733229fa43daf734d41b9e53124bf74">sendTagData()</a> will be called repeatedly.<br/>
 The format of the payload from the host is: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2</th><th>3</th><th>4 </th></tr>
<tr>
<th>Content</th><td>update</td><td>start</td><td>autoAck</td><td>fast</td><td>rssi </td></tr>
</table>
<p>If update is zero the command is ignored. Parameter start defines if the cyclic inventories are started (1) or stopped (0). <br/>
 For description of autoAck, fast and rssi parameters see <a class="el" href="appl__commands_8c.html#af7538f453a5d43b7ec063517853847ac">callInventoryGen2()</a>. <br/>
 The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0 </th></tr>
<tr>
<th>Content</th><td>current start value </td></tr>
</table>
<p>Subsequently <a class="el" href="appl__commands_8c.html#af7538f453a5d43b7ec063517853847ac">callInventoryGen2()</a> result packets are returned in a dense continuous loop. </p>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l02647">2647</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5f0c721b0cbca9df52572cf6592bc9b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callTunerTable </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function allows to update the tuner table. For in detail information to antenna tuning see <a class="el" href="appl__commands_8c.html#a35a9905055fe3ca4c2808d090f714bbf">callAntennaTuner()</a> and <a class="el" href="tuner_8h.html" title="This file provides declarations for tuner related functions.">tuner.h</a>.<br/>
 The function is executed when a stream packet with protocol = <a class="el" href="appl__commands_8h.html#a19a43cfe833cb2428ad80c97b4c8daf1">CMD_TUNER_TABLE</a> is received. The format of the payload received from the host is one of the following: </p>
<ul>
<li>
<p class="startli">Get current tuning table size: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0  </th></tr>
<tr>
<th>Content </th><td>0x00 (SubCmd ID)  </td></tr>
</table>
<p>The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2  </th></tr>
<tr>
<th>Content </th><td>0x00 (SubCmd ID) </td><td>maximum tuning table size this device supports </td><td>current tuning table size  </td></tr>
</table>
<p class="endli"></p>
</li>
<li>
<p class="startli">Delete current tuning table: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0  </th></tr>
<tr>
<th>Content </th><td>0x01 (SubCmd ID)  </td></tr>
</table>
<p>The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2  </th></tr>
<tr>
<th>Content </th><td>0x01 (SubCmd ID) </td><td>maximum tuning table size this device supports </td><td>n/a  </td></tr>
</table>
<p class="endli"></p>
</li>
<li>
<p class="startli">Add new entry in tuning table: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1..3 </th><th>4 </th><th>5 </th><th>6 </th><th>7 </th><th>8..9 </th><th>10 </th><th>11 </th><th>12 </th><th>13 </th><th>14..15  </th></tr>
<tr>
<th>Content </th><td>0x02 (SubCmd ID) </td><td>frequency </td><td>Ant1: tune enable </td><td>Ant1: cin </td><td>Ant1: clen </td><td>Ant1: cout </td><td>Ant1: I+Q </td><td>Ant2: tune enable </td><td>Ant2: cin </td><td>Ant2: clen </td><td>Ant2: cout </td><td>Ant2: I+Q  </td></tr>
</table>
<p>Adds the data to the internal tuning table. The first set of data is for antenna 1 the second set for antenna 2. <br/>
 The device responds: </p>
<table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2  </th></tr>
<tr>
<th>Content </th><td>0x02 (SubCmd ID) </td><td>remaining size in #tuningTable </td><td>n/a  </td></tr>
</table>
<p>If no more space is left in #tuningTable the status will be set to ERR_NOMEM. If adding to #tuningTable was successful status will be set to ERR_NONE. </p>
<p class="endli"></p>
</li>
<li>
If the device does not support antenna tuning or if a unsupported SubCmd ID was received the device sends back: <table class="doxtable">
<tr>
<th>Byte </th><th>0 </th><th>1 </th><th>2  </th></tr>
<tr>
<th>Content </th><td>0xFF </td><td>0x00 </td><td>n/a  </td></tr>
</table>
The reply status will be set to ERR_REQUEST.  </li>
</ul>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l00853">853</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6b5124948787e4620bba229d08ea33ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callWriteToTag </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This function writes to a previously selected (callSelectTag()) gen2 tag
</pre><p> and is executed when a stream packet with protocol = <a class="el" href="appl__commands_8h.html#a13e8d476afe2f6018e8b7dbb72c6f48d">CMD_WRITE_TO_TAG</a> is received. <br/>
 The format of the payload from the host is: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1</th><th>2 .. 5</th><th>6 .. (rxsize-1) </th></tr>
<tr>
<th>Content</th><td>mem_bank</td><td>address</td><td>acces_pw</td><td>data  </td></tr>
</table>
<p>where </p>
<ul>
<li>
mem_bank:<ul>
<li>
0:reserved membank</li>
<li>
1:EPC membank</li>
<li>
2:TID membank</li>
<li>
3:USER membank</li>
</ul>
</li>
<li>
access_pw: if access password is nonzero the tag will be accessed first. (tag enters Secured state.) </li>
</ul>
<p>The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0 </th><th>1  </th></tr>
<tr>
<th>Content</th><td>num_words_written</td><td>tag error code if status==ERR_HEADER </td></tr>
</table>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l01964">1964</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac8c8c214b2260b9c5c2bce49e4d4ed50"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callWriteToTag6B </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section attention"><dt>Attention</dt><dd>Do not use, ISO 6B not supported.</dd></dl>
<p>This function writes to a tag using ISO18000-6b protocol command WRITE. The format of the payload from the host is: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1 .. 8</th><th>9</th><th>10</th><th>11 .. 11+length_to_write </th></tr>
<tr>
<th>Content</th><td><a class="el" href="appl__commands_8h.html#aa8809a923cd0a628e2ccb11208d66b12">CMD_WRITE_TO_TAG_6B</a></td><td>uid</td><td>addr</td><td>length_to_write</td><td>data </td></tr>
</table>
<p>where The device sends back: </p>
<table class="doxtable">
<tr>
<th>Byte</th><th>0</th><th>1 </th></tr>
<tr>
<th>Content</th><td>0x48(ID)</td><td>0 for success </td></tr>
</table>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l01608">1608</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<a class="anchor" id="a84f0c66d6ac5157a6a525c989e5c513f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void callWrongCommand </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Dummy appl command which is called if an invalid command ID was received. Logs error message and returns error ERR_REQUEST to host. </p>

<p>Definition at line <a class="el" href="appl__commands_8c_source.html#l00317">317</a> of file <a class="el" href="appl__commands_8c_source.html">appl_commands.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a4b7b90160112ff5364abdef36111f4dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct callFunction call_fkt_[CALL_FKT_SIZE]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Table of function pointers. The offset in the table matches the command identifier. When a command is received the corresponding function will be called via this table. </p>

<p>Definition at line <a class="el" href="appl__commands__table_8c_source.html#l00066">66</a> of file <a class="el" href="appl__commands__table_8c_source.html">appl_commands_table.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Dec 19 2013 15:32:33 for as3993 Firmware by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
